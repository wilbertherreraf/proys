<ui:composition xmlns="http://www.w3.org/1999/xhtml" xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html" xmlns:f="http://java.sun.com/jsf/core" xmlns:p="http://primefaces.org/ui"
	template="/WEB-INF/templates/tema1/defaultorig.xhtml">

	<ui:define name="head">
		<style type="text/css">
.ui-dialog {
	top: 100px !important;
}
</style>
		<h:outputStylesheet name="vendors/datatables/css/jquery.dataTables.css" />
		<h:outputScript name="vendors/datatables/js/jquery.dataTables.js" />

		<script>
			function initResult() {
				var ex = document.getElementById('form:dtableResult');
				$(ex).dataTable({'iDisplayLength' : 20,
									'aLengthMenu' : [ [ 20, 50, 100, -1 ], [ 20, 50, 100, 'Todo' ] ],
									'sPaginationType' : 'full_numbers',
									'oLanguage' : {
										'sLengthMenu' : 'Mostrar _MENU_ registros por página',
										'sEmptyTable':     'Ningún dato encontrado en la tabla',
										'sSearch' : 'Filtrar:',
										'sInfo':           'Mostrando _START_ a _END_ de _TOTAL_ registros',
										'sInfoFiltered':   '(filtrados de _MAX_ registros)',
									    'sInfoEmpty':      'Mostrando 0 a 0 de 0 registros',
									    'sZeroRecords':    'Ningún registro encontrado',
										 'oPaginate': {
										        'sNext': '&gt;',
										        'sLast': '&gt;&gt;',
										        'sFirst': '&lt;&lt;',
										        'sPrevious': '&lt;'
										     }
									}
								});
			}
		</script>
	</ui:define>

	<ui:define name="description">
		<h3>
			<i class="fa fa-angle-right"></i> BUSQUEDA DE MENSAJES REGISTRADOS ENTRANTES Y SALIENTES
		</h3>
	</ui:define>

	<ui:define name="implementation">
	
		<h:form id="form">
			<p:growl id="growl" autoUpdate="true" life="5000"/>		
			<p:outputPanel id="panelout">
				<div class="panel panel-default">
	                <div class="panel-heading">
	                    Criterios de Búsqueda
	                </div>				
					<div class="panel-body">
              			<div class="form-horizontal">
							<div class="form-group">
							    <h:outputLabel for="menPlano" value="Buscar Texto:" styleClass="col-sm-2 control-label" />
							    <div class="col-sm-10">
									<h:inputText id="menPlano" value="#{swfLoteFormController.swfMensajeSelected.menPlano}" styleClass="form-control" />
									<p:watermark for="menPlano" value="Texto a buscar en mensajes swift" />							    
							    </div>
							</div>              
							<div class="form-group">
							    <h:outputLabel for="chooseDescTabla" value="Estado de Verificación(Scan):" styleClass="col-sm-2 control-label" />
							    <div class="col-sm-10">
									<h:selectOneMenu value="#{swfLoteFormController.swfMensajeSelected.menEstverifica}" styleClass="form-control">
										<f:selectItem itemLabel="TODOS" itemValue="" />
										<f:selectItems value="#{swfLoteFormController.genDesctablaList}" var="itemlista"
											itemLabel="#{itemlista.desDescrip}" itemValue="#{itemlista.id.desCodigo}" />
									</h:selectOneMenu>
							    </div>
							</div>
							<div class="form-group">
							    <h:outputLabel for="input5" value="Tipo:" styleClass="col-sm-2 control-label" />
							    <div class="col-sm-10">
									<h:selectOneMenu id="input5" value="#{swfLoteFormController.swfMensajeSelected.menInout}" styleClass="form-control">
										<f:selectItem itemLabel="TODOS " itemValue="" />
										<f:selectItem itemLabel="Entrantes" itemValue="I" />
										<f:selectItem itemLabel="Salientes" itemValue="O" />
									</h:selectOneMenu>							    
							    </div>
							</div>
							<div class="form-group">
							    <h:outputLabel value="Fecha Registro:" styleClass="col-sm-2 control-label" />
							    <div class="col-sm-10">
									<p:calendar value="#{swfLoteFormController.fecInicio}" effect="fold" pattern="dd/MM/yyyy" size="15" mask="true" showTodayButton="true"
										showOn="button" locale="es"/>
									<p:calendar value="#{swfLoteFormController.fecFin}" effect="fold" pattern="dd/MM/yyyy" size="15" mask="true" showTodayButton="true" 
										showOn="button" locale="es"/>
							    </div>
							</div>
              			</div>
					</div>
                  	<div class="panel-footer">
							<p:commandButton title="Ejecutar consulta de búsqueda" value="Buscar" icon="fa fa-search"
								actionListener="#{swfLoteFormController.search}" oncomplete="initResult();" update=":form:panelresult" styleClass="btn btn-flat">
							</p:commandButton>                  	

							<p:commandButton value="Limpiar" update="panelout :form:panelresult" process="@this" actionListener="#{swfLoteFormController.inicializaObjetos}" >
								<p:resetInput target="panelout"/>
							</p:commandButton>
                  	</div>
			</div>
			</p:outputPanel>
			
			<p:outputPanel id="panelresult">
				<div class="table-responsive">
					<h:dataTable id="dtableResult" var="item" value="#{swfLoteFormController.mensajesDatosSelectedLista}"
						rendered="#{not empty swfLoteFormController.mensajesDatosSelectedLista}" styleClass="table table-striped table-condensed">
						<h:column>
							<f:facet name="header">
								<h:outputText value="Mensaje" />
							</f:facet>
							<h:outputText value="#{item.swfMensaje.menCodmen}" styleClass="label label-success" />
						</h:column>
						<h:column>
							<f:facet name="header">
								<h:outputText value="Corr."
									title="Nro correlativo asignado al mensaje" />
							</f:facet>
							<h:outputText value="#{item.swfMensaje.menNrocorr}" />
						</h:column>						
						<h:column>
							<f:facet name="header">
								<h:outputText value="ID Mensaje"
									title="Identificador mensaje(Salientes: fecha y usuario del creador, entrantes: codigo MIR)" />
							</f:facet>
							<h:outputText value="#{item.swfMensaje.menCodswift}" />
						</h:column>
						<h:column>
							<f:facet name="header">
								<h:outputText value="Cod App" title="Aplicación origen" />
							</f:facet>
							<h:outputText value="#{item.swfMensaje.menCodapp}" />
						</h:column>						
						<h:column>
							<f:facet name="header">
								<h:outputText value="I/O" title="Tipo Mensaje I: Entrante, O: Saliente" />
							</f:facet>
							<h:outputText value="#{item.swfMensaje.menInout}" />
						</h:column>
						<h:column>
							<f:facet name="header">
								<h:outputText value="Tipo mensaje" />
							</f:facet>
							<h:outputText value="#{item.swfMensaje.menCodmt}" title="#{item.menCodmtdescrip}">
							</h:outputText>
						</h:column>
						<h:column>
							<f:facet name="header">
								<h:outputText value="Emisor" title="BIC Entidad Emisora" />
							</f:facet>
							<h:outputText value="#{item.swfMensaje.menEmisor}" />
						</h:column>
						<h:column>
							<f:facet name="header">
								<h:outputText value="Receptor" title="BIC Entidad receptora " />
							</f:facet>
							<h:outputText value="#{item.swfMensaje.menReceiver}" />
						</h:column>
						<h:column>
							<f:facet name="header">
								<h:outputText value="Estado Verificación" />
							</f:facet>
							<h:outputText value="#{item.swfMensaje.genDesctablaEstverifica.desDescrip}" />
						</h:column>
						<h:column>
							<f:facet name="header">
								<h:outputText value="Fecha" />
							</f:facet>
							<h:outputText value="#{item.swfMensaje.menFecreg}">
								<f:convertDateTime pattern="dd/MM/yyyy" />
							</h:outputText>
						</h:column>
						<h:column>
							<f:facet name="header">
								<h:outputText value="Ver" />
							</f:facet>
							<p:commandLink actionListener="#{swfLoteFormController.verReporte(item)}" title="Reporte Swift" ajax="false">
								<i class="fa fa-file-pdf-o"></i>
								<p:fileDownload value="#{swfLoteFormController.fileDown}" />
							</p:commandLink>
							<p:commandLink oncomplete="$('#myModalPlano').modal('show');" title="Ver mensaje plano"
								actionListener="#{swfLoteFormController.seleccionarDetalle(item)}" process="@this">
								<i class="fa fa-file-text-o"></i>
							</p:commandLink>
							<p:commandLink oncomplete="$('#myModalCampos').modal('show');" title="Ver campos"
								actionListener="#{swfLoteFormController.seleccionarDetalle(item)}" process="@this">
								<i class="fa fa-list"></i>
							</p:commandLink>
							<p:commandLink actionListener="#{swfLoteFormController.scanSwiftMessage(item.swfMensaje)}" title="Scanear mensaje"
								rendered="#{swfLoteFormController.isAuthorized('BUSCAROFC')}" process="@this">
								<i class="fa fa-refresh"></i>
							</p:commandLink>
						</h:column>
					</h:dataTable>
				</div>
			</p:outputPanel>

			<ui:include src="swmensaje_modal.xhtml" />			
		</h:form>
	
            <script type="text/javascript">
            	initResult();
            </script>
	</ui:define>

</ui:composition>
